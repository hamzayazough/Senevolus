<app-app-header type="elder"></app-app-header>
<div class="form-container">
    <form (ngSubmit)="onSubmit()" #form="ngForm">
      <div class="name-section">
        <label for="firstName">First Name:</label>
        <input type="text" id="firstName" [(ngModel)]="formData.firstName" name="firstName" placeholder="Enter First Name">
    
        <label for="lastName">Last Name:</label>
        <input type="text" id="lastName" [(ngModel)]="formData.lastName" name="lastName" placeholder="Enter Last Name">
      </div>

      <!-- Role -->
      <div class="radio-group">
        <label for="category">Type of User</label>
        <label class="radio-option">
            <input type="radio" name="category" value="elder" (change)="onCategoryChange($event)">
            <span class="radio-label">Elderly</span>
        </label>
        <label class="radio-option">
            <input type="radio" name="category" value="volunteer" (change)="onCategoryChange($event)">
            <span class="radio-label">Volunteer</span>
        </label>
      </div>

    <!-- Age -->
    <div class="form-group">
      <label for="age">Age:</label>
      <input
        type="number"
        id="age"
        name="age"
        [(ngModel)]="formData.age"
        required
      />
    </div>

    <div class="camera-container">
      <h1>
        {{
          step === 1
            ? "Step 1: Take a Picture of Your ID"
            : "Step 2: Take a Picture of Yourself"
        }}
      </h1>

      <!-- Camera Feed -->
      <div class="camera-section">
        <video #videoElement autoplay class="camera-feed"></video>
        <canvas
          #canvasElement
          class="camera-canvas"
          style="display: none"
          *ngIf="isCameraOn"
        ></canvas>
      </div>

      <!-- Buttons for Step 1 -->
      <div *ngIf="step === 1" class="button-group">
        <button type="button" (click)="startCamera()" *ngIf="!isCameraOn">
          Start Camera
        </button>
        <button type="button" (click)="takePicture()" *ngIf="isCameraOn">
          Capture ID Photo
        </button>
        <button type="button" (click)="stopCamera()" *ngIf="isCameraOn">
          Stop Camera
        </button>
      </div>

      <!-- Buttons for Step 2 -->
      <div *ngIf="step === 2" class="button-group">
        <button type="button" (click)="startCamera()" *ngIf="!isCameraOn">
          Start Camera
        </button>
        <button type="button" (click)="takePicture()" *ngIf="isCameraOn">
          Capture Person Photo
        </button>
        <button type="button" (click)="stopCamera()" *ngIf="isCameraOn">
          Stop Camera
        </button>
      </div>

      <!-- Navigation Between Steps -->
      <div class="step-navigation">
        <button type="button" (click)="previousStep()" *ngIf="step === 2">
          Back to Step 1
        </button>
        <button
          type="button"
          (click)="nextStep()"
          *ngIf="step === 1 && idPhoto"
        >
          Next: Step 2
        </button>
      </div>

      <!-- Display Captured Images -->
      <div *ngIf="idPhoto" class="captured-image">
        <h3>ID Photo</h3>
        <img [src]="idPhoto" alt="Captured ID Photo" />
      </div>

      <div *ngIf="personPhoto" class="captured-image">
        <h3>Person Photo</h3>
        <img [src]="personPhoto" alt="Captured Person Photo" />
      </div>
    </div>

    <!-- Biography -->
    <div class="form-group">
      <label for="biography">Biography:</label>
      <textarea
        id="biography"
        name="biography"
        [(ngModel)]="formData.description"
        rows="5"
        required
      ></textarea>
    </div>

    <!-- Address -->
    <app-address-autocomplete (addressSelected)="onAddressChange($event)"></app-address-autocomplete>    
    <!-- Submit Button -->
    <div class="form-group">
      <button type="submit">Submit</button>
    </div>
  </form>
</div>
